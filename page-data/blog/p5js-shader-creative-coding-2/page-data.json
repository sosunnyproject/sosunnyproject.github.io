{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/p5js-shader-creative-coding-2/","result":{"data":{"site":{"siteMetadata":{"title":"sosunnyproject | Personal Website · Portfolio · Dev Blog · Contact","author":"So Sun Park | sosunnyproject"}},"markdownRemark":{"html":"<h2>Shader Study with P5 Javascript Library (2): Important Shader Concepts</h2>\n<h3>Colors and Position</h3>\n<p>Colors</p>\n<ul>\n<li>RGB values range: 0 ~ 1</li>\n<li>For example, Blue would be (0.0, 0.0, 1.0), Orange (1.0, 0.5, 0.0)</li>\n</ul>\n<p>Position</p>\n<ul>\n<li>range: 0 ~ 1</li>\n<li>width value is 1.0, height value is 1.0 for the shader</li>\n</ul>\n<h3>GLSL Shader Language is Strongly Typed</h3>\n<ul>\n<li>\n<p>Always write numbers in float type. </p>\n<ul>\n<li>Graphics cards can be picky about this.</li>\n</ul>\n</li>\n<li>Define the type of all of variables: int, float, vec2, etc.</li>\n</ul>\n<h3>Get Familiar with Vectors</h3>\n<ul>\n<li>When we need a variable that holds more than one number, we use vec2, vec3, vec4, etc.</li>\n<li>vec2 holds 2 numbers, vec3 holds 3 numbers, and vec4 hold 4 numbers</li>\n<li>In math, vectors are used to indicate positions or directions</li>\n<li>In shader, vectors are also used to store colors</li>\n<li>We can access the numbers inside vectors by using dot. This is called Swizzling</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token comment\">//define vectors</span>\n<span class=\"token keyword\">vec2</span> position <span class=\"token operator\">=</span> <span class=\"token keyword\">vec2</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">vec3</span> color <span class=\"token operator\">=</span> <span class=\"token keyword\">vec3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">vec4</span> colorWithAlpha <span class=\"token operator\">=</span> <span class=\"token keyword\">vec4</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Swizzling: access numbers inside vectors</span>\n<span class=\"token keyword\">float</span> red <span class=\"token operator\">=</span> color<span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float</span> green <span class=\"token operator\">=</span> color<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float</span> blue <span class=\"token operator\">=</span> color<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Explanation of Swizzling from OpenGL wiki</strong> </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Additionally, there are 3 sets of swizzle masks.\nYou can use xyzw, rgba (for colors), or stpq (for texture coordinates).\nThese three sets have no actual difference; they&#39;re just syntactic sugar. \nYou cannot combine names from different sets in a single swizzle operation. \nSo &quot;.xrs&quot; is not a valid swizzle mask.</code></pre></div>\n<h3>Variable Qualifiers: Const, #define, Attribute</h3>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">const</span> <span class=\"token keyword\">float</span> PI <span class=\"token operator\">=</span> <span class=\"token number\">3.141592653</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token expression\">PI <span class=\"token number\">3.141592653</span><span class=\"token punctuation\">;</span></span></span>\n\n<span class=\"token comment\">// vertex data aPosition from p5 webgl</span>\n<span class=\"token keyword\">attribute</span> <span class=\"token keyword\">vec3</span> aPosition<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// copy the position data into a vec4</span>\n  <span class=\"token comment\">// we're using 1.0 as the w component (which controls scaling/normalization of the coordinates)</span>\n  <span class=\"token keyword\">vec4</span> positionVec4 <span class=\"token operator\">=</span> <span class=\"token keyword\">vec4</span><span class=\"token punctuation\">(</span>aPosition<span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  positionVec4<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">=</span> positionVec4<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">*</span> <span class=\"token number\">2.0</span> <span class=\"token operator\">-</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// send the vertex information on to the fragment shader</span>\n  gl_Position <span class=\"token operator\">=</span> positionVec4<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Send data from P5 js (CPU) to Shader (GPU): Uniforms</h3>\n<ul>\n<li><code class=\"language-text\">Uniforms</code> are constant variables.</li>\n<li><code class=\"language-text\">Const</code> is constant per frame, so it can be updated between draw calls.</li>\n<li><code class=\"language-text\">Uniforms</code> can be accessed by all of the parallel threads in our GPU.</li>\n<li>Each thread can read the input data but cannot modify <code class=\"language-text\">Uniform</code>.</li>\n<li>Most common <code class=\"language-text\">uniform</code> to pass from p5 to shaders are <strong>time, resolution, mouse coordinates</strong>.</li>\n<li>Common prefix is <code class=\"language-text\">u</code> or <code class=\"language-text\">u_</code>.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">theShader<span class=\"token punctuation\">.</span><span class=\"token function\">setUniform</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"u_resolution\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ntheShader<span class=\"token punctuation\">.</span><span class=\"token function\">setUniform</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"u_time\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">millis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \ntheShader<span class=\"token punctuation\">.</span><span class=\"token function\">setUniform</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"u_mouse\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span>mouseY<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// flip Y to orient properly in shader</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">uniform</span> <span class=\"token keyword\">vec2</span> u_resolution<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">uniform</span> <span class=\"token keyword\">float</span> u_time<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">uniform</span> <span class=\"token keyword\">vec2</span> u_mouse<span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Typically Used to Pass Texture Coordinates: Varying</h3>\n<ul>\n<li><code class=\"language-text\">Varying</code> is per-fragment / per-pixel parameter.</li>\n<li><code class=\"language-text\">Uniform</code> is same for all pixels. </li>\n<li>We typically use <code class=\"language-text\">varying</code> to pass texture coordinates from p5 webgl (through vertex shader) to fragment shader.</li>\n<li>Common prefix is <code class=\"language-text\">v</code> or <code class=\"language-text\">v_</code>.</li>\n</ul>\n<p><strong>vertex code</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">attribute</span> <span class=\"token keyword\">vec2</span> aTexCoord<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// texture coord from p5/webgl</span>\n<span class=\"token keyword\">varying</span> <span class=\"token keyword\">vec2</span> vTexCoord<span class=\"token punctuation\">;</span> <span class=\"token comment\">// create varying vector</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  vTexCoord <span class=\"token operator\">=</span> aTexCoord<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>fragement code</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">varying</span> <span class=\"token keyword\">vec2</span> vTexCoord<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// grab var from vertex shader</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">vec2</span> uv <span class=\"token operator\">=</span> vTexCoord<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// set texture coord to uv coord</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Texture Coordinates</h3>\n<p><strong>What is TexCoord(texture coordinate), FragCoord(fragment coordinate)?</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Think about your shader as a stretchy cloth and these coord variables as a series of pins that hold the corners tight. \n\nDepending on the location and spacing of these pins your shader can be stretched, distorted, or duplicated in different ways.\n\nTexCoord is calculated in the vertex and passed from the vertex to the fragment shader, and then the texture coordinates of our shader are set to be equal to TexCoord.</code></pre></div>\n<p><strong>TexCoord in .vert file</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">attribute</span> <span class=\"token keyword\">vec2</span> aTexCoord<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// cpu/p5 to vert file</span>\n\n<span class=\"token keyword\">varying</span> <span class=\"token keyword\">vec2</span> vTexCoord<span class=\"token punctuation\">;</span> <span class=\"token comment\">// to move texcoords from vert to frag shader</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//copy the texture coordinates</span>\n  vTexCoord <span class=\"token operator\">=</span> aTexCoord<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>TexCoord in .frag file</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token comment\">// receive vTexCoord from vertex shader</span>\n<span class=\"token comment\">// ranges from 0.0 to 1.0</span>\n<span class=\"token keyword\">varying</span> <span class=\"token keyword\">vec2</span> vTexCoord<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// use a value to access every pixel on the screen</span>\n<span class=\"token keyword\">vec2</span> st <span class=\"token operator\">=</span> vTexCoord<span class=\"token punctuation\">;</span></code></pre></div>\n<h3>FragCoord is used in fragement shader</h3>\n<ul>\n<li>Calculate the texture coordinates relative to the resolution uniform we passed it</li>\n<li>You may see coordinates referred as uv, st, coord, etc. These are just different naming conventions.</li>\n</ul>\n<p><strong>FragCoord in .frag file</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token keyword\">void</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">vec2</span> st <span class=\"token operator\">=</span> gl_FragCoord<span class=\"token punctuation\">.</span>xy<span class=\"token operator\">/</span>u_resolution<span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Reference links</h3>\n<ul>\n<li><a href=\"https://itp-xstory.github.io/p5js-shaders/#/./docs/important-concepts\">https://itp-xstory.github.io/p5js-shaders/#/./docs/important-concepts</a></li>\n<li><a href=\"https://itp-xstory.github.io/p5js-shaders/#/./docs/using-variable-qualifiers\">https://itp-xstory.github.io/p5js-shaders/#/./docs/using-variable-qualifiers</a></li>\n<li><a href=\"https://itp-xstory.github.io/p5js-shaders/#/./docs/using-texture-coordinates\">https://itp-xstory.github.io/p5js-shaders/#/./docs/using-texture-coordinates</a></li>\n</ul>","excerpt":"Shader Study with P5 Javascript Library (2): Important Shader Concepts Colors and Position Colors RGB values range: 0 ~ 1 For example, Blue…","fields":{"slug":"/blog/p5js-shader-creative-coding-2/"},"frontmatter":{"title":"[p5js] Studying Shader with Creative Coding (2)","category":"blog","date":"December 19, 2020"}}},"pageContext":{"slug":"/blog/p5js-shader-creative-coding-2/"}},"staticQueryHashes":["2052298874"]}